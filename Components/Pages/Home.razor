@page "/"
@using System.Net
@using System.Text.Json.Serialization
@using Newtonsoft.Json

@code {
    private readonly string getPlatsUrl = "http://localhost:5150/api/plats";
    private List<Plat>? plats;

    protected override async Task OnInitializedAsync()
    {
        await GetPlatsAsync();
    }

    private async Task GetPlatsAsync()
    {
        using var httpClient = new HttpClient();
        var response = await httpClient.GetAsync(getPlatsUrl);
        if (response.IsSuccessStatusCode)
        {
            var content = await response.Content.ReadAsStringAsync();
            plats = System.Text.Json.JsonSerializer.Deserialize<List<Plat>>(content, new System.Text.Json.JsonSerializerOptions { PropertyNameCaseInsensitive = true });
        }
    }
}

<PageTitle>Cokhot - Home</PageTitle>

<body class="bg-light text-dark">
    <nav class="navbar navbar-expand-lg navbar-light bg-white px-4">
        <a class="navbar-brand d-flex align-items-center" href="#">
            <img src="https://via.placeholder.com/40" alt="Cokhot Logo" class="rounded-circle me-2">
            <span class="fw-bold">Cokhot</span>
        </a>
        <div class="collapse navbar-collapse">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item"><a href="#" class="nav-link">Recipes</a></li>
                <li class="nav-item"><a href="#" class="nav-link">Preferences</a></li>
                <li class="nav-item"><a href="#" class="nav-link">Drinks</a></li>
            </ul>
        </div>
        <a href="#" class="ms-3"><img src="https://via.placeholder.com/30" alt="Profile Icon" class="rounded-circle"></a>
    </nav>

    <main class="container text-center mt-5">
        <div class="d-flex flex-column align-items-center">
            <img src="https://via.placeholder.com/150" alt="Cooking Chick" class="mb-4">
            <h2 class="display-4 fw-bold">What would you like on your plate?</h2>
            <a href="#" class="btn btn-primary mt-3">Let's find out ➔</a>
            <p class="mt-4 fs-3 fw-semibold">100</p>
            <p class="text-muted">registered meals</p>

            @if (plats == null)
            {
                <p>Chargement...</p>
            }
            else
            {
                <ul>
                    @foreach (var plat in plats)
                    {
                        <li>@plat.NomPlat</li>
                    }
                </ul>
            }

            <EditForm  method="post">
                <InputText id="nomPlat" class="form-control mb-3" placeholder="Entrez le nom du plat" />

            </EditForm>

        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
using System.Net;
#line default
